<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <link rel="stylesheet" href="main.css" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  </head>

  <body class="login-page">
    <!-- start login box -->
    <div class="box-login" id="app">
      <div class="body-login">
        <div class="body-child-login">
          <h1>Log in</h1>

          <!-- start login form -->
          <div class="input-div">
            <form id="login-form">
              <div class="input-spacing">
                <input
                  type="username"
                  id="username"
                  class="login-input-field"
                  placeholder="Your username"
                  required=""
                />
              </div>

              <div class="input-spacing">
                <input
                  type="password"
                  id="password"
                  class="login-input-field"
                  placeholder="Password"
                  required=""
                />
              </div>
              <div class="login-button-div">
                <input type="submit" value="Login" />
              </div>
            </form>
          </div>
        </div>
        <!-- end login form -->

        <div class="forgot-div" @click="jump_to_Fpwd()">Forgot password?</div>

        <!-- <div class="sign-div"><span>Don't have an account? </span>Sign up</div> -->
        <div class="sign-div">
          Don't have an account?
          <span @click="jump_to_signup()">Sign up</span>
        </div>
      </div>
    </div>
    <!-- end login box -->

    <script src="js/jquery.js" charset="utf-8"></script>
    <script>
      console.log($("#username").val());
      // start form jquery
      $("#login-form").submit(function (event) {
        event.preventDefault();
        var formData = {
          username: $("#username").val(),
          password: $("#password").val(),
        };
        // validate username and password
        if (formData["username"] == "" || formData["password"] == "") {
          alert("Email or password cannot be empty");
        }
        // start ajax connection
        $.ajax({
          url: "http://localhost:8000/api/users/login/",
          type: "post",
          dataType: "json",
          data: JSON.stringify(formData),
          contentType: "application/json",
          success: function (rs) {
            // store tokens in localStorage
            window.localStorage.setItem("refreshToken", rs.refresh);
            window.localStorage.setItem("accessToken", rs.access);
            alert("Login successful!");
            window.location.href = "index_page.html";
          },
          error: function (xhr, status, error) {
            var errorMessage = xhr.statusText + ": " + xhr.error;
            alert("Error - " + errorMessage);
          },
        });
        // end ajax connection
      });
      // end submit jquery
    </script>
  </body>
</html>
